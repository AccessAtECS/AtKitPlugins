(function(){var g=function(){$lib=AtKit.lib();AtKit.addFn("normalize",function(a){if(a&&a.childNodes){var c=$lib.makeArray(a.childNodes),e=null;$lib.each(c,function(d,b){b.nodeType===3?b.nodeValue===""?a.removeChild(b):e!==null?(e.nodeValue+=b.nodeValue,a.removeChild(b)):e=b:(e=null,b.childNodes&&AtKit.call("normalize",b))})}});AtKit.addFn("unHighlight",function(a){a===null&&(a="body");a=$lib(a).find("span.atkit-highlight");a.replaceWith(a.html())});AtKit.addFn("highlight",function(a){options=a.options;
regex=a.regex;element=a.element;typeof options==="undefined"&&(options={});options.className=options.className||"atkit-highlight";options.tagType=options.tagType||"span";typeof regex==="undefined"||regex.source===""?$lib(element).find(options.tagType+"."+options.className).each(function(){$lib(element).replaceWith($lib(element).text());AtKit.call("normalize",$lib(element).parent().get(0))}):$lib(element).each(function(){var a=$lib(element).get(0);AtKit.call("normalize",a);$lib.each($lib.makeArray(a.childNodes),
function(a,d){var b,c,f,h,g;AtKit.call("normalize",d);if(d.nodeType==3)for(;d.data&&(h=d.data.search(regex))>=0;)if(f=d.data.slice(h).match(regex)[0],f.length>0)b=document.createElement(options.tagType),b.style.background="yellow",b.className=options.className,g=d.parentNode,c=d.splitText(h),d=c.splitText(f.length),f=c.cloneNode(!0),b.appendChild(f),g.replaceChild(b,c);else break;else AtKit.call("highlight",{options:options,regex:regex,element:d})})});return $lib(element)})};typeof window.AtKit==
"undefined"?(window.AtKitLoaded=function(){var a=null;this.subscribe=function(c){a=c};this.fire=function(c,e){a!==null&&a(c,e)}},window.AtKitLoaded=new AtKitLoaded,window.AtKitLoaded.subscribe(function(){AtKit.registerPlugin("highlighter",g)})):AtKit.registerPlugin("highlighter",g)})();
